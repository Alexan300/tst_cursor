# ECG Analysis Interface с алгоритмом Томсона

## Описание

Приложение для анализа ЭКГ сигналов с использованием алгоритма Томсона (Pan-Tompkins) для детекции R-пиков. Включает интерактивный интерфейс с возможностью настройки параметров алгоритма в реальном времени.

## Основные возможности

### Алгоритм Томсона (Pan-Tompkins)
- **Полосовая фильтрация** (5-15 Гц) для выделения QRS комплексов
- **Дифференцирование** сигнала для подчеркивания быстрых изменений
- **Возведение в квадрат** для устранения отрицательных значений
- **Интегрирование с окном** для сглаживания и выделения пиков
- **Адаптивные пороги** для автоматической настройки чувствительности

### Настраиваемые параметры

1. **Чувствительность** (0.1 - 2.0)
   - Меньшие значения = более строгая детекция (меньше ложных срабатываний)
   - Большие значения = более чувствительная детекция (больше пиков)

2. **Минимальное расстояние между пиками** (100 - 500 мс)
   - Контролирует минимальный интервал между соседними R-пиками
   - Помогает избежать множественных детекций одного пика

3. **Окно интегрирования** (50 - 200 мс)
   - Размер окна для сглаживания дифференцированного сигнала
   - Влияет на форму и четкость пиков

4. **Окно поиска** (20 - 100 мс)
   - Окно для поиска точного положения R-пика в исходном сигнале
   - Увеличивает точность позиционирования пиков

### Интерфейс

- **График исходного ЭКГ** с отмеченными R-пиками
- **Этапы алгоритма Томсона** - визуализация всех этапов обработки
- **Усредненный комплекс** - результат усреднения всех найденных комплексов
- **Спектр усредненного комплекса** - частотный анализ
- **Выбранный комплекс** - детальный просмотр отдельного комплекса

### Функции

- **Фильтр Notch 50 Гц** - устранение сетевых помех
- **Выделение регионов** - исключение артефактных участков
- **Ручная разметка** - добавление/удаление пиков вручную
- **Сохранение/загрузка параметров** - сохранение удачных настроек
- **Снимок экрана** - копирование в буфер обмена

## Использование

1. **Запуск приложения:**
   ```bash
   python ecg_average_gui2.py
   ```

2. **Загрузка данных:**
   - Файл → Открыть запись... → выберите .bin файл

3. **Настройка алгоритма:**
   - Используйте слайдеры в панели "Параметры алгоритма Томсона"
   - Параметры обновляются автоматически при изменении

4. **Оптимизация детекции:**
   - Начните с чувствительности 1.0
   - Увеличьте чувствительность, если пропускаются пики
   - Уменьшите чувствительность, если много ложных срабатываний
   - Настройте минимальное расстояние между пиками

5. **Сохранение настроек:**
   - Файл → Сохранить параметры... → выберите место сохранения

## Требования

- Python 3.7+
- numpy
- scipy
- matplotlib
- tkinter
- PIL
- pywin32 (для Windows)

## Установка зависимостей

```bash
pip install numpy scipy matplotlib pillow pywin32
```

## Структура файлов

- `ecg_average_gui2.py` - основное приложение
- `README.md` - данная документация

## Алгоритм Томсона

Алгоритм Pan-Tompkins является одним из наиболее эффективных методов детекции R-пиков в ЭКГ сигналах. Он включает следующие этапы:

1. **Предварительная фильтрация** - полосовой фильтр для выделения частот QRS комплекса
2. **Дифференцирование** - подчеркивание быстрых изменений
3. **Возведение в квадрат** - устранение отрицательных значений и подчеркивание пиков
4. **Интегрирование** - сглаживание и формирование пиков
5. **Адаптивные пороги** - автоматическая настройка чувствительности
6. **Поиск и проверка** - поиск точных позиций пиков с проверкой ограничений

## Поддержка

При возникновении проблем или вопросов обращайтесь к разработчику.
АС Малиновский. 
